<!-- ======================================== -->
    <!-- ======================================== -->
    <!-- ===============footer=================== -->

    <div class="container-fluid footer sec_padding bg_img" style="background-image: url('{{ asset(env('ASSETS_PATH') . '/frontend/images/footer_pattern.jpg') }}');">
      <div class="container">
        <div class="row footer_row">
          <div class="col-lg-3 col-md-7 footer_col">
            <h3 class="mb-3">
              The Backwaters Lodge
            </h3>
            <div class="mb-2">
              <a href="tel:+94763313119">+94 763 313119</a>
            </div>
  
            <div class="mb-2">
              <a href="mailto:thebackwaters.lk@gmail.com">thebackwaters.lk@gmail.com</a>
            </div>

            <div>
              <p>Old Mannar road <br>
                New Eluwankuluma <br>
                Puttalam</p>
            </div>

            <div class="footer_social">
            
              <a href="">
                <div class="link">
                  <i class="fab fa-facebook-f"></i>
                </div>
              </a>
            
              <a href="">
                <div class="link">
                  <i class="fab fa-instagram"></i>
                </div>
              </a>
            
              <a href="">
                <div class="link">
                  <i class="fab fa-youtube"></i>
                </div>
              </a>
            
            </div>
            
          </div>

          <div class="col-lg-3 col-md-5">
            <div class="row g-1">
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_1.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_2.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_3.png')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_4.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_5.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_6.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_7.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_8.jpg')}}" alt="" class="w-100">
              </div>
              <div class="col-md-4 col-sm-2 col-4">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_img_9.jpg')}}" alt="" class="w-100">
              </div>
            </div>
          </div>

          <div class="col-lg-6 col-12 mt-lg-0 mt-5 mb-md-2 mb-5">
            <div class="row">
              <div class="col-sm-2 col-3">
                <a href="">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_1.png')}}" alt="" class="w-100">
                </a>
              </div>
              <div class="col-sm-2 col-3">
                <a href="">
                <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_2.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_3.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_4.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_5.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_6.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_7.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_8.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_12.png')}}" alt="" class="w-100">
                </a>
              </div>

              <div class="col-sm-2 col-3">
                <a href="">
                  <img src="{{ asset(env('ASSETS_PATH').'/frontend/images/footer_ico_13.png')}}" alt="" class="w-100">
                </a>
              </div>

             

            </div>
          </div>

        </div>
      </div>
    </div>


    <!-- ================================= -->
    <!-- ================================= -->
    <!-- ================================= -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/js/jquery-3.2.1.min.js')}}"></script>
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/js/popper.min.js')}}" ></script> 
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/js/bootstrap.min.js')}}" ></script>

  


    <!-- Swiper JS -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.3.5/js/swiper.min.js'></script>

    <!-- vanilla-tilt -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.2/vanilla-tilt.min.js'></script>
    
    <!-- loading effect -->
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/js/aos.js')}}"></script>

    <!-- date picker -->
    <script src='https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.1.4/dist/js/datepicker-full.min.js'></script>
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/date_picker/date_picker.js')}}"></script>
    <!-- date picker -->

    <!-- Tooltip -->
    <script>
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
      })
    </script>
    <!-- Tooltip -->
    
    <script>
      AOS.init({
        easing: 'ease-out-back',
        duration: 1000
      });
    </script>
    <!-- loading effect -->

    <!-- Ad popup js  -->
    <script>
      window.addEventListener("load", () => {
        const promoBox = document.querySelector(".promotion-ad-wrapper");
        const closeButton = document.querySelector(".promo-close-btn");
        const discountButton = document.querySelector(".disc_btn");
    
        if (promoBox && closeButton) {
          if (window.innerWidth > 991) {
            // For screens wider than 991px
            let reappearanceTimer = null;
    
            // Show the promo box automatically
            promoBox.classList.add("show");
    
            closeButton.addEventListener("click", () => {
              promoBox.classList.remove("show");
              clearTimeout(reappearanceTimer);
              reappearanceTimer = setTimeout(() => {
                promoBox.classList.add("show");
              }, 30000); // Reappears after 30 seconds
            });
    
          } else {
            // For screens 991px wide or smaller
            if (discountButton) {
              discountButton.addEventListener("click", () => {
                promoBox.classList.add("show");
              });
            }
    
            closeButton.addEventListener("click", () => {
              promoBox.classList.remove("show");
            });
          }
        }
      });
    </script>
    <!-- Ad popup js  -->

    <!-- Sticky Header JS  -->
    <script>
      document.addEventListener("DOMContentLoaded", function() {
          
          const navBar = document.querySelector('.nav_bar');
          
          if (navBar) {
              let lastScrollY = window.scrollY;
   
              const showThreshold = 400;
              const hideThreshold = 500;
   
              window.addEventListener('scroll', () => {
                  const currentScrollY = window.scrollY;
  
                  const isSticky = navBar.classList.contains('sticky-header');
   
                  if (currentScrollY > lastScrollY) {
                      
                      if (currentScrollY > showThreshold) {
                          
                          if (!isSticky) {
                              navBar.classList.remove('is-hiding'); 
                              navBar.classList.add('sticky-header');
                          }
                      }
                  } else {
                      
                      if (currentScrollY < hideThreshold) {
                          
                          if (isSticky) {
                              
                              navBar.classList.add('is-hiding');
  
                              setTimeout(() => {
                                  navBar.classList.remove('sticky-header');
                                  navBar.classList.remove('is-hiding'); 
                              }, 500); 
                          }
                      }
                  }
                  
                  lastScrollY = currentScrollY <= 0 ? 0 : currentScrollY;
              });
          }
      });
    </script>
    <!-- Sticky Header JS  -->

    <script>
      var swiper = new Swiper(".accomodation_swiper", {
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
        loop: true,
        spaceBetween: 30,
      });
    </script>

    <script>
      var swiper = new Swiper(".img_only_slider", {
        pagination: {
        el: ".pagination",
        clickable: true,

        },
        clickable: true,
        loop: true,
        autoplay: {
        delay: 3500,
        },

      });
    </script>

    <!-- Parallax Background JS  -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
          const parallaxBgs = document.querySelectorAll('.parallax-bg');


          function updateParallax() {
              parallaxBgs.forEach(bg => {
                  const scrollPosition = window.pageYOffset;
                  const sectionTop = bg.parentElement.offsetTop;
                  const sectionHeight = bg.parentElement.offsetHeight;


                  if (scrollPosition > sectionTop - window.innerHeight &&
                      scrollPosition < sectionTop + sectionHeight) {

                      const distance = scrollPosition - sectionTop;

                      const translateY = distance * 0.2;

                      bg.style.transform = `translateY(${translateY}px)`;
                  }
              });
          }

          updateParallax();

          window.addEventListener('scroll', updateParallax);
      });
    </script>
    <!-- Parallax Background JS  -->


    
    <!-- tour slider -->

    <script>
        // Caption texts for each slide
        const captions = [
            'Bird Life',
            'Hangouts', 
            'Wildlife',
            'Hangouts',
            'Guest Areas'
        ];
        
        // Update caption based on active slide
        function updateCaption(index) {
            const captionElement = document.getElementById('current-caption');
            if (captionElement && captions[index]) {
                captionElement.textContent = captions[index];
            }
        }
        
        // Update counter based on active slide
        function updateCounter(index) {
            const counterElement1 = document.getElementById('slide-counter');
            const counterElement2 = document.getElementById('slide-counter2');

            const current = String(index + 1).padStart(2, '0');
            const total = String(captions.length).padStart(2, '0');

            if (counterElement1) {
                counterElement1.textContent = `${current} / ${total}`;
            }

            if (counterElement2) {
                counterElement2.textContent = current;
            }
        }
        
        // Initialize Swiper after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize with first caption and counter
            updateCaption(0);
            updateCounter(0);
            
            // Initialize Swiper
            const swiper = new Swiper('.tour_slider', {
                loop: true,
                speed: 800,
                effect: 'slide',
                // centeredSlides: true,
                loop: 'true',
                autoplay: {
                    delay: 4000,
                    disableOnInteraction: false,
                },

                navigation: true,
                
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },

                slidesPerView: 2,
                spaceBetween: 30, 

                breakpoints: {
                    767: {
                        slidesPerView: 1,
                        spaceBetween: 40
                    }
                },

                on: {
                    slideChange: function () {
                        updateCaption(this.realIndex);
                        updateCounter(this.realIndex);
                    },
                    init: function() {
                        // Ensure initial state is set correctly
                        updateCaption(this.realIndex);
                        updateCounter(this.realIndex);
                    }
                }
            });
        });
    </script>
    <!-- tour slider -->


    <!-- scroll top -->
    <script type="module">
      import ScrollTop from 'https://cdn.skypack.dev/smooth-scroll-top';
      const scrollTop = new ScrollTop();
      scrollTop.init();
    </script>
    <!-- scroll top -->

    

    <!-- gallery -->
    <script src="{{ asset(env('ASSETS_PATH').'/frontend/gallery/fancybox.min.js')}}"></script>
    <!-- gallery -->

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        const submitBtn = document.querySelector("button[type='submit']");

        form.addEventListener("submit", function (e) {
            let hasError = false;

            // Validate Name
            const name = document.getElementById("nameInput");
            if (!name.value.trim()) {
                name.classList.add("is-invalid");
                hasError = true;
            } else {
                name.classList.remove("is-invalid");
            }

            // Validate Email
            const email = document.getElementById("emailInput");
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email.value.trim() || !emailPattern.test(email.value.trim())) {
                email.classList.add("is-invalid");
                hasError = true;
            } else {
                email.classList.remove("is-invalid");
            }

            // Validate Comment
            const comment = document.getElementById("commentTextarea");
            if (!comment.value.trim()) {
                comment.classList.add("is-invalid");
                hasError = true;
            } else {
                comment.classList.remove("is-invalid");
            }

            if (hasError) {
                e.preventDefault(); // stop form submission
            }
        });
    });
</script>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

<script>

document.getElementById('contactForm').addEventListener('submit', async function(event) {
    event.preventDefault(); // Prevent default form submission

    // Clear previous error messages
    const errorElements = document.querySelectorAll('.invalid-feedback');
    errorElements.forEach(element => element.textContent = '');

    const formMessages = document.getElementById('form-messages');
    formMessages.innerHTML = '';

    // Get form field values
    const fullName = document.getElementById('fullName').value.trim();
    const email = document.getElementById('email').value.trim();
    const country = document.getElementById('country').value.trim();
    const checkInDate = document.getElementById('checkInDate').value.trim();
    const checkOutDate = document.getElementById('checkOutDate').value.trim();
    const message = document.getElementById('message').value.trim();
    const turnstileResponse = document.querySelector('input[name="cf-turnstile-response"]')?.value;

    let isValid = true;

    // Validation checks
    if (!fullName) {
        document.getElementById('fullName').nextElementSibling.textContent = 'Full Name is required';
        isValid = false;
    }

    if (!email) {
        document.getElementById('email').nextElementSibling.textContent = 'Email Address is required';
        isValid = false;
    } else if (!isValidEmail(email)) {
        document.getElementById('email').nextElementSibling.textContent = 'Please enter a valid email address';
        isValid = false;
    }

    if (!country) {
        document.getElementById('country').nextElementSibling.textContent = 'Country is required';
        isValid = false;
    }

    if (!checkInDate) {
        document.getElementById('checkInDate').nextElementSibling.textContent = 'Check-in date is required';
        isValid = false;
    }

    if (!checkOutDate) {
        document.getElementById('checkOutDate').nextElementSibling.textContent = 'Check-out date is required';
        isValid = false;
    } else if (checkInDate && checkOutDate && new Date(checkOutDate) <= new Date(checkInDate)) {
        document.getElementById('checkOutDate').nextElementSibling.textContent = 'Check-out date must be after check-in date';
        isValid = false;
    }

    if (!message) {
        document.getElementById('message').nextElementSibling.textContent = 'Message is required';
        isValid = false;
    }

    if (!turnstileResponse) {
        console.error('Turnstile response is missing. Check if Turnstile widget loaded correctly.');
        formMessages.innerHTML = '<div class="alert alert-danger">Please complete the CAPTCHA verification.</div>';
        isValid = false;
    }

    // Submit form via AJAX if valid
    if (isValid) {
        try {
            // Ensure Turnstile is ready
            if (typeof turnstile !== 'undefined') {
                const formData = new FormData();
                formData.append('_token', document.querySelector('input[name="_token"]').value);
                formData.append('name', fullName);
                formData.append('email', email);
                formData.append('country', country);
                formData.append('check_in_date', checkInDate);
                formData.append('check_out_date', checkOutDate);
                formData.append('message', message);
                formData.append('cf-turnstile-response', turnstileResponse);

                const response = await fetch('{{ route('contact-us.store') }}', {
                    method: 'POST',
                    body: formData,
                });

                const result = await response.json();

                if (response.ok) {
                    formMessages.innerHTML = `<div class="alert alert-success">${result.message}</div>`;
                    document.getElementById('contactForm').reset(); // Reset form on success
                } else {
                    formMessages.innerHTML = `<div class="alert alert-danger">${result.message || 'An error occurred. Please try again.'}</div>`;
                }
            } else {
                console.error('Turnstile script not loaded.');
                formMessages.innerHTML = '<div class="alert alert-danger">CAPTCHA service is unavailable. Please try again later.</div>';
            }
        } catch (error) {
            console.error('Form submission error:', error);
            formMessages.innerHTML = '<div class="alert alert-danger">An error occurred during submission. Please try again.</div>';
        }
    } else {
        formMessages.innerHTML = '<div class="alert alert-danger">Please fill in all required fields correctly.</div>';
    }
});

// Email validation helper
function isValidEmail(email) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

// Debugging Turnstile load
window.addEventListener('load', function () {
    if (typeof turnstile === 'undefined') {
        console.error('Cloudflare Turnstile script failed to load.');
        document.getElementById('form-messages').innerHTML = '<div class="alert alert-warning">CAPTCHA service failed to load. Please refresh the page.</div>';
    }
});
</script>


<div class="cf-turnstile" data-sitekey="{{ env('TURNSTILE_SITE_KEY') }}" data-callback="onTurnstileSuccess"></div>

<script>
function onTurnstileSuccess(token) {
    console.log('Turnstile token generated:', token);
    document.querySelector('input[name="cf-turnstile-response"]').value = token;
}
</script>




// Email validation function
function isValidEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

// Add real-time validation on input
const inputs = document.querySelectorAll('#contactForm input, #contactForm textarea');
inputs.forEach(input => {
    input.addEventListener('input', function() {
        if (this.value.trim()) {
            this.nextElementSibling.textContent = '';
        }
    });
});
</script>

